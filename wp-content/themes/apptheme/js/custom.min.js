!function(window,document,$,undefined){"use strict";parent&&parent.postMessage("site_loaded","*");var app={appp:"undefined"!=typeof window.appp?window.appp:!1,woo:"undefined"!=typeof window.apppwoo?window.apppwoo:!1,snapper:new Snap({element:document.getElementById("page"),disable:"right",hyperextensible:!1,touchToDrag:!1}),spinner:null,scriptsLoaded:{},stylesLoaded:{},xhr:[],scriptsLoadedCount:0,stylesLoadedCount:0,backhref:"",backLoad:!1,history:[],laststate:window.location.href,timeout:!1,isWidth600:!0,$:{},modalID:""};app.cacheSelectors=function(){app.$.body=$("body"),app.$.main=$("#main"),app.$.ajaxModal=$("#ajaxModal"),app.$.modalInside=$(".modal-inside"),app.$.ioModal=$(".io-modal")},app.init=function(){app.cacheSelectors();var a;if(app.appp){app.log("window.appp",app.appp),app.log("window.apppwoo",app.woo),setTimeout(function(){app.scriptLoader(),app.styleLoader(),app.setCurrentNav()},1e3),appp.can_ajax?(window.history.replaceState({},"",window.location.href),(0===app.history.length||app.history.length&&app.history[0].url!=window.location.href)&&app.history.unshift({url:window.location.href}),sessionStorage.urlHistory||(sessionStorage.urlHistory=JSON.stringify(app.history))):($(".pull-left .back").on("click",function(){window.history.back()}),1==window.history.length&&$(".pull-left .back").hide()),app.$.body.append('<div class="ajax-spinner"><div class="spinner"></div></div>'),app.$.spinner=$(".ajax-spinner"),$(".site-header").on("touchmove",function(a){a.preventDefault()}),$(".site-footer").on("touchmove",function(a){a.preventDefault()});var b=new Hammer($(".site-title-wrap").get(0));if(b.on("doubletap",function(a){app.$.main.animate({scrollTop:0},"fast")}),$("body").on("click","#main a",function(a){var b=new RegExp("/"+window.location.host+"/");b.test(a.target.href)||$(this).is('[href*="#"]')||"A"!=a.target.tagName||(a.preventDefault(),a.stopPropagation(),window.open(a.target.href,"_blank"))}),window.matchMedia&&(a=window.matchMedia("(min-width: 600px)"),a.addListener(function(a){app.isWidth600=a.matches,app.log("Width "+(app.isWidth600?">":"<")+" 600")})),app.logGroup(!0),app.isWidth600=a&&a.matches,app.$.subMenu=$(".snap-drawer li").has("ul.sub-menu, ul.children").children("a").addClass("has-sub-menu"),app.$.subMenu.next("ul").prepend('<a href="#" class="menu-back"><i class="fa fa-angle-left fa-lg"></i> '+l10n.back+"</a>"),app.$.subMenu.append('<i class="fa fa-angle-right fa-lg pull-right"></i>'),app.backhref=app.woo&&app.woo.is_shop?app.woo.shop_url:app.appp.home_url,app.$.body.on("click",".ajaxify, .ajaxify a, .blog .post a, li.previous a, li.next a, .entry-meta a, .entry-title a, .page-links a, .comment-author a, .woocommerce-pagination a, a.wc-forward, .bbp-forum-title a, #bbpress-forums a, a.item-link, .appp-below-post a",function(a){var b=$(this);app.canAjax(b)&&app.loadAjaxContent(b.attr("href"),!1,a)}).on("click",".snap-drawer li a",function(a){var b=$(this),c=b.hasClass("has-sub-menu"),d=b.parent().hasClass("external");c&&$(a.target).next("ul").addClass("open-sub-menu"),d&&window.open($(this).attr("href"),"_blank"),app.canAjax(b)&&(app.loadAjaxContent(b.attr("href"),!1,a),app.isWidth600||"left"!=app.snapper.state().state||c||app.snapper.close())}).on("click",".footer-menu a",function(a){var b=$(this);app.canAjax(b)&&(app.loadAjaxContent(b.attr("href"),!1,a),app.isWidth600||"left"!=app.snapper.state().state||app.snapper.close())}).on("click","a.back",function(a){a.preventDefault(),app.backLoad=!0;var b=JSON.parse(sessionStorage.urlHistory);b.length<=1||(b.shift(),setTimeout(function(){app.loadAjaxContent(b[0].url,!1,a)},0),sessionStorage.urlHistory=JSON.stringify(b))}).on("click",".menu-back",function(a){a.preventDefault(),$(this).closest("ul").removeClass("open-sub-menu")}).on("click","a.modal-toggle, .modal-toggle a",function(a){if(apppresser.canModal($(this))){a.preventDefault();var b=this.href+" #content";app.$.ajaxModal.modal(),app.$.modalInside.load(b)}}).on("click",".comment-reply-login",function(a){a.preventDefault(),$(".snap-drawer .io-modal-open").trigger("click")}).on("click","#nav-left-open",function(){"left"==app.snapper.state().state?app.snapper.close():app.snapper.open("left")}).on("click",".io-modal-open, .io-modal-close",function(a){a.preventDefault();var b="slide-in-up-add ng-animate slide-in-up slide-in-up-add-active",c="slide-in-up-remove slide-in-up-remove-active";$(this).hasClass("io-modal-open")?(app.modalID=$(this).attr("href"),"#loginModal"==app.modalID&&$("input[name=redirect_to]").val(window.location),$("#error-message").html(" "),$(app.modalID).css("display","block").removeClass(c).addClass(b)):($(".io-modal").removeClass(b).addClass(c).css("display","none"),$("form").trigger("reset"),app.$.spinner.hide())}).on("submit","form#loginform",function(a){var b=$(this).serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{});(""===b.log||""===b.pwd)&&a.preventDefault()}),app.snapper.on("open",function(){app.$.ioModal.data("isOpen")&&app.ioModal.close()}),FastClick.attach(document.body),document.addEventListener("offline",function(){alert(l10n.offline)},!1),"function"==typeof Hammer&&window.appp.can_ajax){var c=document.getElementById("main"),d=new Hammer(c);d.on("swipe",function(a){var b=$('.appp-below-post a[rel="next"]').attr("href"),c=$('.appp-below-post a[rel="prev"]').attr("href");a.deltaX>=100?c&&apppresser.loadAjaxContent(c):a.deltaX<=-100&&b&&apppresser.loadAjaxContent(b)})}}},app.ioModal=function(){var a="slide-in-up-add ng-animate slide-in-up slide-in-up-add-active",b="slide-in-up-remove slide-in-up-remove-active";return{open:function(){app.$.ioModal.removeClass(b).addClass(a).data("isOpen",!0).trigger("isOpen")},close:function(){app.$.ioModal.removeClass(a).addClass(b).data("isOpen",!1).trigger("isClosed"),setTimeout(function(){app.$.ioModal.removeClass(b)},150)}}}(),app.setCurrentNav=function(){var a=$('.has-sub-menu[href="'+window.location.href+'"]');if(a.length){a.next("ul").addClass("open-sub-menu");for(var b=a.parents(".sub-menu");b.length;)b.addClass("open-sub-menu"),b=b.parents(".sub-menu")}},app.scriptLoader=function(a){a=a||$("script[src]");var b,c,d={},e=0,f="length"in app.scriptsLoaded;return app.scriptsLoaded.length=f?app.scriptsLoaded.length:0,a.each(function(){var a=$(this);return a.data("loaded")===!0?!0:(c=a.attr("src"),b=c.replace(/^.*[\\\/]/,"").replace(/(\?.*)|(#.*)/g,""),b in app.scriptsLoaded?!0:(app.scriptsLoaded.length++,e++,app.scriptsLoaded[b]=c,d[b]=c,void a.data("loaded",!0)))}),app.log("scriptLoader"),e?(f&&app.log("addedscripts",e,d),app.log("app.scriptsLoaded",app.scriptsLoaded),app.log("END scriptLoader"),d):(app.log("No new scripts to load."),d)},app.styleLoader=function(a){a=a||$('link[type="text/css"]');var b,c,d={},e=0,f="length"in app.stylesLoaded;return app.stylesLoaded.length=f?app.stylesLoaded.length:0,a.each(function(){var a=$(this);return a.data("loaded")===!0?!0:(c=a.attr("href"),b=c.replace(/^.*[\\\/]/,"").replace(/(\?.*)|(#.*)/g,""),b in app.stylesLoaded?!0:(app.stylesLoaded.length++,e++,app.stylesLoaded[b]=c,d[b]=c,void a.data("loaded",!0)))}),app.log("styleLoader"),e?(f&&app.log("addedStyles",e,d),app.log("app.stylesLoaded",app.stylesLoaded),app.log("END styleLoader"),d):(app.log("No new styles to load."),d)},app.loadAjaxContent=function(a,b,c){if(c){var d=c.target;c.preventDefault()}var e=a.split("/");if("#"!==e[e.length-1].charAt(0)||$(d).parent().hasClass("back")){var f={title:$("title"),navtitle:$(".site-title-wrap h1")};if(b=b||app.$.main,a=a||this.href,app.timeout&&clearTimeout(app.timeout),$.each(app.xhr,function(a,b){b.abort()}),app.doingAjax!==!0){app.doingAjax=!0,app.$.spinner.show(),setTimeout(function(){app.$.spinner.hide()},6e4);var g="undefined"==typeof c?0:c.currentTarget.className.indexOf("transition-left"),h="undefined"==typeof c?0:c.currentTarget.className.indexOf("transition-right"),i=$.ajax({url:a,type:"GET",dataType:"html",cache:!1}).done(function(c){parent&&g>=0?parent.postMessage("native_transition_left","*"):parent&&h>=0&&parent.postMessage("native_transition_right","*");var d=$("<div>").append($.parseHTML(c,document,!0)),e=d.find("#main"),i={title:d.find("title"),navtitle:d.find(".site-title-wrap h1")},j=e.attr("class").replace("site-main",""),k=e.children().unwrap(),l=d.find("#top-menu3"),m=d.find(".pull-left"),n=(d.find(".io-modal"),d.find("#activity-post-form")),o=app.scriptLoader(d.find("script[src]")),p=app.styleLoader(d.find('link[type="text/css"]'));app.$.body.attr("class",j),app.$.main.attr("class",j),f.title.text(i.title.text()),f.navtitle.html(i.navtitle.html()),$("#top-menu3").replaceWith(l),$(".pull-left").replaceWith(m),$("#activity-post-form").replaceWith(n),b.html(k),app.change_url(a),app.timeout=setTimeout(function(){$.each(o,function(a,b){app.log("$.each(scripts)",a,b);var c=app.loadScript(b,!0,function(){app.scriptsLoadedCount++,app.log("script retrieved",b),app.log("scripts retrieved",app.scriptsLoadedCount)});c&&(c.done(function(a,b,c){}).fail(function(a,c,d){app.log("loadScript: Triggered ajaxError handler for: "+b,d)}),app.xhr.push(c))}),$.each(p,function(a,b){app.log("$.each(styles)",a,b),app.loadCSS(b),app.stylesLoadedCount++,app.log("style retrieved",b),app.log("styles retrieved",app.stylesLoadedCount)})},30),$(document).trigger("load_ajax_content_done",$,b,a),app.$.body.trigger("post-load",$,b,a),parent&&parent.postMessage("load_ajax_content_done","*")}).complete(function(a,b){var c;app.$.spinner.fadeOut("fast"),"success"===b&&(app.$.main.animate({scrollTop:0},"fast"),$(d).parents().hasClass("footer-menu")&&(c=$(d).attr("href"),$(".footer-menu li").removeClass("current_page_item"),$(d).parent().addClass("current_page_item"),$("#site-navigation ul.menu li").removeClass("current_page_item"),$('#site-navigation ul.menu a[href="'+c+'"]').parent().addClass("current_page_item")),$(d).parents().hasClass("menu")&&(c=$(d).attr("href"),$("#site-navigation ul.menu li").removeClass("current_page_item"),$(d).parent().addClass("current_page_item"),$(".footer-menu li").removeClass("current_page_item"),$('.footer-menu a[href="'+c+'"]').parent().addClass("current_page_item")))});app.xhr.push(i),app.doingAjax=!1}}},app.canAjax=function(a){return apppresser.appp.can_ajax&&!a.is(".menu-back, .external, .no-ajax, .menu .no-ajax > a, .nav-divider, .modal-toggle, .modal-toggle a")||a.is(".back")},app.canModal=function(a){return apppresser.appp.can_ajax&&!a.is("a.no-modal, .no-modal a")},app.change_url=function(a){a=a||apppresser.backhref,window.history.pushState({},"",a);var b=JSON.parse(sessionStorage.urlHistory);app.backLoad||(0===b.length||b.length&&b[0].url!=window.location.href)&&b.unshift({url:a}),sessionStorage.urlHistory=JSON.stringify(b),app.backLoad=!1},app.loadL10n=function(html){var inlineScripts=html.find("script[type='text/javascript']").text(),pattern=/\/\* <!\[CDATA\[ \*\/([\s\S]*)\/\* \]\]> \*\//,matches=inlineScripts.match(pattern),script=matches[1];eval(script)},app.loadScript=function(a,b,c){var d=!1,e=null;return $.isFunction(b)?(e=b,d=c||d):(d=b||d,e=c||e),$.ajax({url:a,type:"GET",dataType:"script",cache:d,success:e})},app.loadCSS=function(a){var b=$("<link>");$("head").append(b),b.attr({rel:"stylesheet",type:"text/css",href:a})},app.untrailingslashit=function(a){return"/"==a.substr(-1)?a.substr(0,a.length-1):a},app.log=function(){this.appp.debug&&console&&"function"==typeof console.log&&console.log.apply(console,arguments)},app.logGroup=function(a,b){this.appp.debug&&console&&"function"==typeof console.group&&(a===!0?console.groupEnd():"undefined"==typeof a?b?console.group():console.groupCollapsed():b?console.group(a):console.groupCollapsed(a))},app.newPassword=function(){var a=$(".reset-code-rsp");if(console.log("newPassword"),""===$("#lost_email").val())return a.html("Email required."),!1;a.html('<i class="fa fa-cog fa-spin"></1>');var b={action:"app-lost-password",email:$("#lost_email").val(),nonce:$("#app_new_password").val()};console.dir(b);var c=$.ajax({type:"post",url:apppCore.ajaxurl,dataType:"json",data:b,success:function(b){console.dir(b),a.html(b.data.message),$("input[type=text]").val(""),$("input[type=password]").val("")},error:function(a){console.log("Password reset error "+a)}});return c},app.changePassword=function(){var a=$("#app-pw").val(),b=$("#app-pwr").val(),c=$("#reset-code").val(),d=$(".psw-msg");if(console.log("changePassword"),a!=b||""===a)return d.html("Passwords do not match."),!1;if(""===c)return d.html("Please enter your reset code."),!1;d.html('<i class="fa fa-cog fa-spin"></i>');var e={action:"app-validate-password",code:c,password:a,nonce:$("#app_new_password").val()},f=$.ajax({type:"post",url:apppCore.ajaxurl,dataType:"json",data:e,success:function(a){d.html(a.data.message),$("#app-pw").val(""),$("#app-pwr").val(""),a.data.success&&(d.append(" Logging you in..."),setTimeout(function(){window.location.reload()},1e3))}});return f},$("body").on("click","#app-new-password",app.newPassword).on("click","#app-change-password",app.changePassword),app.appendComment=function(a,b){var c;c=$($(".comment-list")?".comment-list":"#comments"),console.log("Append ",c),c.append('<li class="comment" id="ajax-comment"> <article class="comment-body"> <footer class="comment-meta"> <div class="comment-author vcard"> <cite class="fn">'+a+'</cite> <span class="says">says:</span></div><!-- .comment-author --> <div class="comment-metadata"></div><!-- .comment-metadata --> <p class="comment-awaiting-moderation">Your comment is awaiting moderation.</p> </footer><!-- .comment-meta --> <div class="comment-content"> <p>'+b+"</p> </div><!-- .comment-content --> </article><!-- .comment-body --> </li>")},$("body").on("click","#respond #submit",function(){var a=$(this).closest("#respond").find("#comment"),b=$.trim(a.val());if(""===b)return alert(appp.i18n_required_comment_text),!1;var c=$(this).closest("#respond").find("#rating"),d=c.val();return c.size()>0&&!d&&"yes"===wc_single_product_params.review_rating_required&&""!==b?(alert(wc_single_product_params.i18n_required_rating_text),!1):void 0}),$("body").hasClass("logged-in")&&$(".ajax-comment-form-author, .ajax-comment-form-email, .ajax-comment-form-url").hide(),$("body").on("click",".comment-reply-link",function(){var a=/\b\d+/,b=a.exec(this.href);$("#ajax-comment-parent").val(b),$(".appp-comment-btn").trigger("click")}).on("click","#ajax-comment-form-submit #submit",function(){var a,b=$("#commentform"),c=$("#comment-status"),d=$(".ajax-comment-form-author #author").val(),e=$(".ajax-comment-form-email #email").val(),f=$(".ajax-comment-form-comment #comment").val(),g=$("#ajax-comment-parent").val(),h=$("body").hasClass("logged-in");if(h)$(".ajax-comment-form-author, .ajax-comment-form-email, .ajax-comment-form-url").hide(),a={comment_post_ID:$("#commentform #comment_post_ID").val(),comment:f,comment_parent:g};else{if(!d||!e||!f)return c.html('<p class="ajax-error" >Please fill out required fields.</p>'),!1;a={author:d,email:e,url:$(".ajax-comment-form-url #url").val(),comment_post_ID:$("#commentform #comment_post_ID").val(),comment:f,comment_parent:g}}c.html('<p class="ajax-placeholder">Processing...</p>');var i=b.attr("action");return $.ajax({type:"post",url:i,data:a,error:function(a,b,d){c.html('<p class="ajax-error" >You might have left one of the fields blank, or be posting too quickly</p>')},success:function(a,e){"success"==e?(c.html('<p class="ajax-success" >Thanks for your comment. We appreciate your response.</p>'),app.appendComment(d,f),setTimeout(function(){$(".io-modal-close").trigger("click")},1500)):(c.html('<p class="ajax-error" >Please wait a while before posting your next comment</p>'),b.find("textarea[name=comment]").val(""))}}),!1}),app.init(),window.apppresser=app}(window,document,jQuery);